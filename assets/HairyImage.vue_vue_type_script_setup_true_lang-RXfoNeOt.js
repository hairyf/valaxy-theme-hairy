import{ah as g,i,ai as ee,Y as te,P as ae,U as z,aj as se,ak as ne,d as _,R as re,S as oe,al as le,I as p,am as ie,an as ce,C as ue,b as u,c as m,r as B,h as H,t as de,f as a,M as L,F as O,a2 as x,g as w,e as F,w as fe,a1 as ve,T as pe,ao as me,ap as ge,aq as ye,ar as we,as as V,Z as he,V as Le}from"./app-DoOrpxZc.js";import{E as Se}from"./index-CZM-WbPl.js";const Ee=(s,n)=>{if(!g||!s||!n)return!1;const t=s.getBoundingClientRect();let r;return n instanceof Element?r=n.getBoundingClientRect():r={top:0,right:window.innerWidth,bottom:window.innerHeight,left:0},t.top<r.bottom&&t.bottom>r.top&&t.right>r.left&&t.left<r.right},Ie=["class","style"],Ce=/^on[A-Z]/,be=(s={})=>{const{excludeListeners:n=!1,excludeKeys:t}=s,r=i(()=>((t==null?void 0:t.value)||[]).concat(Ie)),d=te();return d?i(()=>{var o;return ee(Object.entries((o=d.proxy)==null?void 0:o.$attrs).filter(([f])=>!r.value.includes(f)&&!(n&&Ce.test(f))))}):i(()=>({}))},M=ae({hideOnClickModal:Boolean,src:{type:String,default:""},fit:{type:String,values:["","contain","cover","fill","none","scale-down"],default:""},loading:{type:String,values:["eager","lazy"]},lazy:Boolean,scrollContainer:{type:z([String,Object])},previewSrcList:{type:z(Array),default:()=>se([])},previewTeleported:Boolean,zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},closeOnPressEscape:{type:Boolean,default:!0},zoomRate:{type:Number,default:1.2},minScale:{type:Number,default:.2},maxScale:{type:Number,default:7},crossorigin:{type:z(String)}}),ke={load:s=>s instanceof Event,error:s=>s instanceof Event,switch:s=>ne(s),close:()=>!0,show:()=>!0},ze=["src","loading","crossorigin"],Be={key:0},_e=_({name:"ElImage",inheritAttrs:!1}),Ne=_({..._e,props:M,emits:ke,setup(s,{emit:n}){const t=s;let r="";const{t:d}=re(),o=oe("image"),f=le(),j=be(),S=p(),y=p(!1),v=p(!0),E=p(!1),h=p(),c=p(),D=g&&"loading"in HTMLImageElement.prototype;let I,C;const K=i(()=>[o.e("inner"),b.value&&o.e("preview"),v.value&&o.is("loading")]),Y=i(()=>f.style),U=i(()=>{const{fit:e}=t;return g&&e?{objectFit:e}:{}}),b=i(()=>{const{previewSrcList:e}=t;return Array.isArray(e)&&e.length>0}),q=i(()=>{const{previewSrcList:e,initialIndex:l}=t;let $=l;return l>e.length-1&&($=0),$}),N=i(()=>t.loading==="eager"?!1:!D&&t.loading==="lazy"||t.lazy),k=()=>{g&&(v.value=!0,y.value=!1,S.value=t.src)};function W(e){v.value=!1,y.value=!1,n("load",e)}function X(e){v.value=!1,y.value=!0,n("error",e)}function T(){Ee(h.value,c.value)&&(k(),R())}const A=ie(T,200,!0);async function P(){var e;if(!g)return;await me();const{scrollContainer:l}=t;ge(l)?c.value=l:ye(l)&&l!==""?c.value=(e=document.querySelector(l))!=null?e:void 0:h.value&&(c.value=we(h.value)),c.value&&(I=V(c,"scroll",A),setTimeout(()=>T(),100))}function R(){!g||!c.value||!A||(I==null||I(),c.value=void 0)}function Z(e){if(e.ctrlKey){if(e.deltaY<0)return e.preventDefault(),!1;if(e.deltaY>0)return e.preventDefault(),!1}}function G(){b.value&&(C=V("wheel",Z,{passive:!1}),r=document.body.style.overflow,document.body.style.overflow="hidden",E.value=!0,n("show"))}function J(){C==null||C(),document.body.style.overflow=r,E.value=!1,n("close")}function Q(e){n("switch",e)}return ce(()=>t.src,()=>{N.value?(v.value=!0,y.value=!1,R(),P()):k()}),ue(()=>{N.value?P():k()}),(e,l)=>(u(),m("div",{ref_key:"container",ref:h,class:L([a(o).b(),e.$attrs.class]),style:ve(a(Y))},[y.value?B(e.$slots,"error",{key:0},()=>[H("div",{class:L(a(o).e("error"))},de(a(d)("el.image.error")),3)]):(u(),m(O,{key:1},[S.value!==void 0?(u(),m("img",x({key:0},a(j),{src:S.value,loading:e.loading,style:a(U),class:a(K),crossorigin:e.crossorigin,onClick:G,onLoad:W,onError:X}),null,16,ze)):w("v-if",!0),v.value?(u(),m("div",{key:1,class:L(a(o).e("wrapper"))},[B(e.$slots,"placeholder",{},()=>[H("div",{class:L(a(o).e("placeholder"))},null,2)])],2)):w("v-if",!0)],64)),a(b)?(u(),m(O,{key:2},[E.value?(u(),F(a(Se),{key:0,"z-index":e.zIndex,"initial-index":a(q),infinite:e.infinite,"zoom-rate":e.zoomRate,"min-scale":e.minScale,"max-scale":e.maxScale,"url-list":e.previewSrcList,crossorigin:e.crossorigin,"hide-on-click-modal":e.hideOnClickModal,teleported:e.previewTeleported,"close-on-press-escape":e.closeOnPressEscape,onClose:J,onSwitch:Q},{default:fe(()=>[e.$slots.viewer?(u(),m("div",Be,[B(e.$slots,"viewer")])):w("v-if",!0)]),_:3},8,["z-index","initial-index","infinite","zoom-rate","min-scale","max-scale","url-list","crossorigin","hide-on-click-modal","teleported","close-on-press-escape"])):w("v-if",!0)],64)):w("v-if",!0)],6))}});var Te=pe(Ne,[["__file","image.vue"]]);const Ae=he(Te),$e=_({__name:"HairyImage",props:M,setup(s){const n=s,t=Le("HairyImageGroup:preview",void 0);return(r,d)=>(u(),F(a(Ae),x(n,{class:["HairyImage",[a(t)&&"cursor-pointer rounded"]],onClick:d[0]||(d[0]=o=>{var f;return(f=a(t))==null?void 0:f(r.src)})}),null,16,["class"]))}});export{$e as _};
